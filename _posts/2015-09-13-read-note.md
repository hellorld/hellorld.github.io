---
layout: post
title: 《Effective c++》读书笔记
categories: 读书笔记
tags: c++
---

这篇文章主要就是摘录《Effective c++》里的经典条款，以便回顾。（会不断更新）

---

### 虚析构函数 

1、virtual析构函数的主要作用在于，当你delete掉一个指向派生类的基类指针时，能够调用到正确的析构函数，既派生类的析构函数，防止只析构了基类部分，造成资源泄漏和对象损坏。

2、带多态性质的base class应该声明一个virtual析构函数，如果class 带有任何vitual函数，它就应该有一个virtual析构函数。

3、class的设计目的如果不是作为base class使用，或不是为了具备多态性，就不该声明virtual析构函数。

4、析构函数也可以是纯虚函数，但是你必须为这个pure virtual析构函数提供一份定义。

### 构造函数和析构函数

1、构造函数和析构函数中不要调用虚函数。假设在基类的构造函数中调用了虚函数(该虚函数在派生中进行了重写)，在构造派生类对象的时候，由于会优先构造基类对象，因此会调用基类中的虚函数，而不是派生类中的相应函数。

2、析构函数中若抛出异常，必须进行捕捉，要么吞掉，要么中止程序。

### operator=

1、令赋值操作符（operator=）返回一个reference to *this。这样做可以保证连续赋值的正确性，所有可能会进行连续赋值的都应该这么做。如+=、-=等。

2、确保当对象自我赋值时`operator=` 有良好行为。其中技术包括比较“来源对象”和“目标对象”的地址、精心周到的语句顺序、以及`copy-and-swap`。这么做是确保`operator=`的“自我赋值安全性”和“异常安全性”。

3、确定任何函数如果操作一个以上的对象，而其中多个对象时同一个对象时，其行为仍然正确。

4、copying函数（包括拷贝构造函数和赋值运算符函数）应该确保赋值“对象内的所有成员变量”及“所有base class成分”。通过调用基类的copying函数实现。

5、不要尝试以某个copying函数实现另一个copying函数。应该将共同代码部分放进第三个函数中，并由两个copying函数共同调用。

### 资源管理

1、把资源放进对象里，依赖c++的析构函数自动调用机制确保资源被释放。
2、常用的资源管理对象是智能指针，但是删除对象时要注意delete和delete[]的区别。
